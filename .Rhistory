autoplot(prcomp(wnv_df_trial), data = wnv_df_test, colour = 'Population', frame=TRUE, frame.type='norm', main= "PCA of West Nile Virus Genomic Data by Top Three Sampling Counties")+
theme_classic()
ca_base <- counties(state= c("CA"), cb= T, class= "sf")
ggplot() +
geom_sf(data = ca_base)
ggplot() +
geom_sf(data = ca_base) + theme_classic()
ggplot() +
geom_sf(data = ca_base) + theme_few()
ggplot() +
geom_sf(data = ca_base) + theme_minimal()
ggplot() +
geom_sf(data = ca_base) + theme_gray()+
ggplot() +
geom_sf(data = ca_base) + theme_gray(
q
ggplot() +
ggplot() +
geom_sf(data = ca_base) + theme_gray()
county_map <- ggplot() +
geom_sf(data = ca_base, fill=NA, color="white") + theme_gray()
county_map <- ggplot() +
geom_sf(data = ca_base, fill=NA, color="white") + theme_gray()
county_map <- ggplot() +
geom_sf(data = ca_base, fill="grey", color="white") + theme_nothing()
ca_base <- counties(state= c("CA"), cb= T, class= "sf")
county_map <- ggplot() +
geom_sf(data = ca_base, color="grey") + theme_nothing()
ggplot() +
geom_sf(data = ca_base, color="grey")
+ theme_nothing()
ca_base <- counties(state= c("CA"), cb= T, class= "sf")
ggplot() +
geom_sf(data = ca_base, color="grey")
+ theme_nothing()
ggplot() +
geom_sf(data = ca_base, color="grey")+
theme_nothing()
San_Diego_county <-
Sacramento_county <-
ditch_the_axes <- theme(
axis.text = element_blank(),
axis.line = element_blank(),
axis.ticks = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank()
)
county_map <- ggplot() +
geom_sf(data = ca_base, color="grey")+
ditch_the_axes
ggplot() +
geom_sf(data = ca_base, color="grey")+
ditch_the_axes
county_map <- ggplot() +
geom_sf(data = ca_base, color="grey")+
theme_bw()+
ditch_the_axes
ggplot() +
geom_sf(data = ca_base, color="grey")+
theme_bw()+
ditch_the_axes
ggplot() +
geom_sf(data = ca_base, color="grey")+
theme_bw()
county_map <- ggplot() +
geom_sf(data = ca_base, color="grey", bg= NULL)+
theme_bw()
ggplot() +
geom_sf(data = ca_base, color="grey", bg= NULL)+
theme_bw()
ggplot() +
geom_sf(data = ca_base, color="grey", bg= "white")+
theme_bw()
ggplot() +
geom_sf(data = ca_base, color="grey")+
theme_bw() +
ditch_the_axes
ggplot() +
geom_sf(data = ca_base, color="grey")+
theme_nothing() +
ditch_the_axes
ggplot() +
geom_sf(data = ca_base, color="grey")+
theme_nothing() +
ditch_the_axes
ggplot() +
geom_sf(data = ca_base, color="grey")+
theme_nothing()
ggplot() +
geom_sf(data = ca_base, color="grey")+
theme_few() +
ditch_the_axes
ggplot() +
geom_sf(data = ca_base, color="grey")+
theme_void() +
ditch_the_axes
ggplot() +
geom_sf(data = ca_base, color="grey")+
theme_void()
kern_county <- geom_sf(data = Kern, fill="red", alpha=.5)
Kern <- larimer <- ca_base %>%
filter(NAME == "Kern")
Kern <- ca_base %>%
filter(NAME == "Kern")
kern_county <- geom_sf(data = Kern, fill="red", alpha=.5)
kern <- ca_base %>%
filter(NAME == "Kern")
kern_county <- geom_sf(data = Kern, fill="red", alpha=.5)
g
kern_county <- geom_sf(data = Kern, fill="brown1", alpha=.5)
San_Diego <- ca_base %>%
filter(NAME == "San Diego")
San_Diego_county <- geom_sf(data = San_Diego, fill="aquamarine2", alpha=.5)
Sacramento <- ca_base %>%
filter( NAME=="Sacramento")
Sacramento_county <- geom_sf(data = San_Diego, fill="darkorchid1", alpha=.5)
kern <- ca_base %>%
filter(NAME == "Kern")
Sacramento <- ca_base %>%
filter( NAME=="Sacramento")
Sacramento_county <- geom_sf(data = Sacramento, fill="darkorchid1", alpha=.5)
_
county_map <- ggplot() +
geom_sf(data = ca_base, color="grey")+
theme_void() +
Sacramento_county +
kern_county +
San_Diego_county
county_map
San_Diego <- ca_base %>%
filter(NAME == "San Diego")
San_Diego_county <- geom_sf(data = San_Diego, fill="darkorchid1", alpha=.5)
Sacramento <- ca_base %>%
filter( NAME=="Sacramento")
Sacramento_county <- geom_sf(data = Sacramento, fill="aquamarine2", alpha=.5)
county_map <- ggplot() +
geom_sf(data = ca_base, color="grey")+
theme_void() +
Sacramento_county +
kern_county +
San_Diego_county
county_map
Sacramento_county <- geom_sf(data = Sacramento, fill="cyan2", alpha=.5)
county_map <- ggplot() +
geom_sf(data = ca_base, color="grey")+
theme_void() +
Sacramento_county +
kern_county +
San_Diego_county
county_map
Sacramento_county <- geom_sf(data = Sacramento, fill="cyan3", alpha=.5)
county_map <- ggplot() +
geom_sf(data = ca_base, color="grey")+
theme_void() +
Sacramento_county +
kern_county +
San_Diego_county
county_map
kern_county <- geom_sf(data = Kern, fill="brown1", alpha=.75)
San_Diego_county <- geom_sf(data = San_Diego, fill="darkorchid1", alpha=.75)
Sacramento_county <- geom_sf(data = Sacramento, fill="cyan3", alpha=.75)
county_map <- ggplot() +
geom_sf(data = ca_base, color="grey")+
theme_void() +
Sacramento_county +
kern_county +
San_Diego_county
county_map
kern_county <- geom_sf(data = Kern, fill="brown1", alpha=.25)
San_Diego_county <- geom_sf(data = San_Diego, fill="darkorchid1", alpha=.25)
Sacramento_county <- geom_sf(data = Sacramento, fill="cyan3", alpha=.25)
county_map <- ggplot() +
geom_sf(data = ca_base, color="grey")+
theme_void() +
Sacramento_county +
kern_county +
San_Diego_county
county_map
kern_county <- geom_sf(data = Kern, fill="brown1", alpha=.35)
San_Diego_county <- geom_sf(data = San_Diego, fill="darkorchid1", alpha=.35)
Sacramento_county <- geom_sf(data = Sacramento, fill="cyan3", alpha=.35)
county_map <- ggplot() +
geom_sf(data = ca_base, color="grey")+
theme_void() +
Sacramento_county +
kern_county +
San_Diego_county
county_map
cleanest_wnv_input <- "fasta/wnv_cleanest.fas"
fasta_read_cleanest <- ape::read.dna(cleanest_wnv_input, format='fasta')
setwd("C:/Users/Rebecca/Desktop/Homework 5/NSCI535-westnile-omics")
cleanest_wnv_input <- "fasta/wnv_cleanest.fas"
fasta_read_cleanest <- ape::read.dna(cleanest_wnv_input, format='fasta')
cleanest_wnv_input <- "fasta/wnv_cleanest.fas"
fasta_read_cleanest <- ape::read.dna(cleanest_wnv_input, format='fasta')
setwd("C:/Users/Rebecca/Desktop/Homework 5/NSCI535-westnile-omics/fasta")
cleanest_wnv_input <- "wnv_cleanest.fas"
fasta_read_cleanest <- ape::read.dna(cleanest_wnv_input, format='fasta')
library(tidyverse)
library(tidycensus) ##tidycensus package
library(leaflet)
library(stringr)
library(sf)
library(dplyr)
library(adegenet)
library(pegas)
library(Biostrings)
library(dplyr)
library(seqinr)
library(ape)
library(ShortRead)
library(ggplot2)
library(ggmap)
library(maps)
library(mapdata)
library(tigris)
library(adegenet)
library(spdep)
library(dartR) ## One good lesson. If you develope a package be sure to include all the dependencies in the installation you twat
library(csv)
library(DECIPHER)
input <- "wnv_clean.fas"
fasta.read <- ape::read.dna(input, format='fasta')
San_Diego_county <- geom_sf(data = San_Diego, fill="darkorchid1", alpha=.35)+
geom_sf_text(data=San_Diego, aes(label=NAME), color= "black")
Sacramento_county <- geom_sf(data = Sacramento, fill="cyan3", alpha=.35)+
geom_sf_text(data=Sacramento, aes(label=NAME), color= "black")
kern_county <- geom_sf(data = Kern, fill="brown1", alpha=.35)+
geom_sf_text(data=kern, aes(label=NAME), color= "black")
county_map <- ggplot() +
geom_sf(data = ca_base, color="grey")+
theme_void() +
Sacramento_county +
kern_county +
San_Diego_county
county_map
Sacramento_county <- geom_sf(data = Sacramento, fill="cyan3", alpha=.35)+
geom_sf_text(data=Sacramento, aes(label= NAME), color= "black")
San_Diego_county <- geom_sf(data = San_Diego, fill="darkorchid1", alpha=.35)+
geom_sf_text(data=San_Diego, aes(label=NAME), color= "black")
kern_county <- geom_sf(data = Kern, fill="brown1", alpha=.35)+
geom_sf_text(data=kern, aes(label=NAME), color= "black")
county_map <- ggplot() +
geom_sf(data = ca_base, color="grey")+
theme_void() +
Sacramento_county +
kern_county +
San_Diego_county
county_map <- ggplot() +
geom_sf(data = ca_base, color="grey")+
theme_void() +
Sacramento_county +
kern_county +
San_Diego_county
county_map
Sacramento <- ca_base %>%
filter( NAME=="Sacramento")
San_Diego <- ca_base %>%
filter(NAME == "San Diego")
kern <- ca_base %>%
filter(NAME == "Kern")
kern_county <- geom_sf(data = Kern, fill="brown1", alpha=.35)+
geom_sf_text(data=kern, aes(label=NAME), color= "black")
San_Diego <- ca_base %>%
filter(NAME == "San Diego")
San_Diego_county <- geom_sf(data = San_Diego, fill="darkorchid1", alpha=.35)+
geom_sf_text(data=San_Diego, aes(label=NAME), color= "black")
Sacramento <- ca_base %>%
filter( NAME=="Sacramento")
Sacramento_county <- geom_sf(data = Sacramento, fill="cyan3", alpha=.35)+
geom_sf_text(data=Sacramento, aes(label= NAME), color= "black")
county_map <- ggplot() +
geom_sf(data = ca_base, color="grey")+
theme_void() +
Sacramento_county +
kern_county +
San_Diego_county
county_map
kern_county <- geom_sf(data = Kern, fill="brown1", alpha=.35)+
geom_sf_text(data=kern, aes(label=NAME))
San_Diego_county <- geom_sf(data = San_Diego, fill="darkorchid1", alpha=.35)+
geom_sf_text(data=San_Diego, aes(label=NAME))
Sacramento_county <- geom_sf(data = Sacramento, fill="cyan3", alpha=.35)+
geom_sf_text(data=Sacramento, aes(label= NAME))
county_map <- ggplot() +
geom_sf(data = ca_base, color="grey")+
theme_void() +
Sacramento_county +
kern_county +
San_Diego_county
county_map
kern_county <- geom_sf(data = Kern, fill="brown1", alpha=.35)
San_Diego_county <- geom_sf(data = San_Diego, fill="darkorchid1", alpha=.35)
Sacramento_county <- geom_sf(data = Sacramento, fill="cyan3", alpha=.35)
county_map <- ggplot() +
geom_sf(data = ca_base, color="grey")+
theme_void() +
Sacramento_county +
kern_county +
San_Diego_county
county_map
wnv_df_test <- read.csv("data/wnv_test1.csv")
setwd("C:/Users/Rebecca/Desktop/Homework 5/NSCI535-westnile-omics")
wnv_df_test <- read.csv("data/wnv_test1.csv")
wnv_df_test <- read.csv("wnv_test1.csv")
autoplot(prcomp(wnv_df_trial2), data = wnv_df_test2, colour = 'population', frame=TRUE, frame.type='norm') +theme_classic()
library(ggfortify)
library(ggplot2)
library(ade4)
library(adegraphics)
input <- "wnv_clean.fas"
fasta.read <- ape::read.dna(input, format='fasta')
input <- "fasta/wnv_clean.fas"
fasta.read <- ape::read.dna(input, format='fasta')
wnv_df_test <- read.csv("wnv_test1.csv")
wnv_df_test <- read.csv("C:\Users\Rebecca\Desktop\Homework 5\NSCI535-westnile-omics\wnv_test1.csv")
wnv_df_test <- read.csv("C:/Users/Rebecca/Desktop/Homework 5/NSCI535-westnile-omics/wnv_test1.csv")
wnv_df_trial <- wnv_df_test[c(3:157)]
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, error = FALSE, comment = FALSE)
options(readr.show_progress = FALSE)
library(tidyverse)
library(ggthemes)
library(seqinr)
library(purrr)
library(dplyr)
library(readr)
library(phyloseq)
library(stringr)
library(tidyr)
library(lubridate)
library(forcats)
library(tigris)
library(knitr)
library(ggplot2)
library(sf)
library(ggdendro)
library(leaflet)
library(viridisLite)
library(RColorBrewer)
library(dendextend)
library(seqinr)
library(ggfortify)
library(ggplot2)
library(ade4)
library(adegraphics)
library(adegenet)
library(spdep)
library(dartR)
library(csv)
library(gridExtra)
library(stringr)
library(sf)
library(ape)
library(ShortRead)
library(ggmap)
library(tigris)
# if (!requireNamespace("BiocManager", quietly = TRUE))
#    install.packages("BiocManager")
# BiocManager::install("Biostrings", versilibrary(devtools) on = "3.8"
library(Biostrings)
# if (!requireNamespace("BiocManager", quietly=TRUE))
# install.packages("BiocManager")
# BiocManager::install("msa")
library(msa)
# if (!requireNamespace("BiocManager", quietly = TRUE))
#     install.packages("BiocManager")
# BiocManager::install("DECIPHER", version = "3.8")
library(DECIPHER)
wn_meta_filtered <- read.csv("../data/metadata/metadata.csv") %>%
select(Scripps.ID, Species, Sample.type, Collection.date, County, Latitude, Longitude)
wn_meta_sum_county <- wn_meta_filtered %>%
group_by(County) %>%
summarize(
n = n()) %>%
ungroup()
wn_meta_sum_county %>%
mutate(County = fct_reorder(County, n)) %>%
ggplot(aes(x = County, y = n)) +
geom_point() +
coord_flip() +
theme_minimal() +
labs(title = "Samples collected by county", x = NULL, y = "# of samples")
wn_meta_sum_species <- wn_meta_filtered %>%
filter(Sample.type == "Tissue") %>%
group_by(Species) %>%
summarize(
n = n()) %>%
ungroup()
wn_meta_sum_species %>%
mutate(Species = fct_reorder(Species, n)) %>%
ggplot(aes(x = Species, y = n)) +
geom_point() +
coord_flip() +
theme_minimal() +
labs(title = "Samples collected by bird species", x = NULL, y = "# of samples")
wn_meta_sum_mosquitos <- wn_meta_filtered %>%
filter(Sample.type == "Pooled mosquitos") %>%
group_by(Species) %>%
summarize(
n = n()) %>%
ungroup()
wn_meta_sum_mosquitos %>%
mutate(Species = fct_reorder(Species, n)) %>%
ggplot(aes(x = Species, y = n)) +
geom_point() +
coord_flip() +
theme_minimal() +
labs(title = "Samples collected by mosquito species", x = NULL, y = "# of samples")
##PCA
wnv_df <- read.csv("../data/wnv_test1.csv")
wnv_df_pca <- wnv_df[c(3:157)] ##ignore the first identifier collumns for PCA
wnv_df_pca <- as.data.frame(wnv_df_pca)
wnv_pca <- prcomp(wnv_df_pca)
wnv_pca_plot <- autoplot(wnv_pca, data = wnv_df, colour = 'Population', frame=TRUE, frame.type='norm', main= "PCA of West Nile Population Structure") +theme_classic() #Run pca (prcomp) and plot grouping by pop data in original dataframe
###Cali Map
ca_base <- counties(state= c("CA"), cb= T, class= "sf")
kern <- ca_base %>%
filter(NAME == "Kern")
kern_county <- geom_sf(data = kern, fill="brown1", alpha=.35)
San_Diego <- ca_base %>%
filter(NAME == "San Diego")
San_Diego_county <- geom_sf(data = San_Diego, fill="darkorchid1", alpha=.35)
Sacramento <- ca_base %>%
filter( NAME=="Sacramento")
Sacramento_county <- geom_sf(data = Sacramento, fill="cyan3", alpha=.35)
county_map <- ggplot() +
geom_sf(data = ca_base, color="grey")+
theme_minimal() +
Sacramento_county +
kern_county +
San_Diego_county
grid.arrange(wnv_pca_plot, county_map, nrow=1)
# import dataset that Rebecca made:
clean_seq <- readDNAStringSet("../data/fasta/clear_wnv_clean.fas")
#import metadata
metadataframe <- read_csv('../data/metadata/metadata.csv')
metadataframe <- metadataframe %>%
rename_all(tolower)
# unmasked clustering
sdist <- stringDist(as(clean_seq,"DNAStringSet"), method="hamming")
clust <- hclust(sdist, method = "ward.D2")
dend <- as.dendrogram(clust)
dend_data <- dendro_data(dend, type = 'rectangle')
dend <- assign_values_to_leaves_edgePar(dend, value = colors, edgePar = "col") # add colors
library(tidyverse)
library(ggthemes)
library(seqinr)
library(purrr)
library(dplyr)
library(readr)
library(phyloseq)
library(stringr)
library(tidyr)
library(lubridate)
library(forcats)
library(tigris)
library(knitr)
library(ggplot2)
library(sf)
library(ggdendro)
library(leaflet)
library(viridisLite)
library(RColorBrewer)
library(dendextend)
library(seqinr)
library(ggfortify)
library(ggplot2)
library(ade4)
library(adegraphics)
library(adegenet)
library(spdep)
library(dartR)
library(csv)
library(gridExtra)
library(stringr)
library(sf)
library(ape)
library(ShortRead)
library(ggmap)
library(tigris)
# if (!requireNamespace("BiocManager", quietly = TRUE))
#    install.packages("BiocManager")
# BiocManager::install("Biostrings", versilibrary(devtools) on = "3.8"
library(Biostrings)
# if (!requireNamespace("BiocManager", quietly=TRUE))
# install.packages("BiocManager")
# BiocManager::install("msa")
library(msa)
# if (!requireNamespace("BiocManager", quietly = TRUE))
#     install.packages("BiocManager")
# BiocManager::install("DECIPHER", version = "3.8")
library(DECIPHER)
# import dataset that Rebecca made:
clean_seq <- readDNAStringSet("../data/fasta/clear_wnv_clean.fas")
#import metadata
metadataframe <- read_csv('../data/metadata/metadata.csv')
metadataframe <- metadataframe %>%
rename_all(tolower)
# unmasked clustering
sdist <- stringDist(as(clean_seq,"DNAStringSet"), method="hamming")
clust <- hclust(sdist, method = "ward.D2")
dend <- as.dendrogram(clust)
dend_data <- dendro_data(dend, type = 'rectangle')
dend <- assign_values_to_leaves_edgePar(dend, value = colors, edgePar = "col") # add colors
install.packages("msa")
install.packages("msa")
BiocManager::install("msa", version = "3.8")
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, error = FALSE, comment = FALSE)
options(readr.show_progress = FALSE)
library(msa)
dend <- assign_values_to_leaves_edgePar(dend, value = colors, edgePar = "col") # add colors
